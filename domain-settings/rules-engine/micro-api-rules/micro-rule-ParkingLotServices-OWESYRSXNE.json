{"type":15,"data":{"domainKey":"OWESYRSXNE","name":"ParkingLotServices","desc":null,"code":"\r\nimport io.boodskap.iot.MicroApi;\r\nimport groovy.json.JsonSlurper;\r\n      \r\n//ParkingLot List API\r\n@MicroApi(\r\n          desc = \"ParkingLot List API Service\",\r\n          params = [\"garage_id\",\"domain_key\"],\r\n          types = [\"string\",\"string\"], // if declared, make sure it matches the params[]\r\n          required = [],\r\n          roles = [], // domain roles, empty roles for open access\r\n          slug = \"\" // optional short name for REST API access\r\n)\r\ndef list(def args) {\r\n\r\n\r\n    def response = [reqStatus:false];\r\n    \r\n    def jsonSlurper = new JsonSlurper();\r\n    \r\n    try{\r\n        //def inputObj = jsonSlurper.parseText(args.query);\r\n        def result = record.search(2001,'{ \"query\": { \"bool\": { \"must\": [ { \"match\": { \"domainKey\": \"'+args.domain_key+'\" } }, { \"match\": { \"garage_id\": \"'+args.garage_id+'\" }}, { \"match\": { \"garage_name\": \"'+args.garage_name+'\" }} ] } }, \"sort\": [{ \"updated_time\": {\"order\": \"desc\"}}], \"size\": 1000, \"from\": 0 }');\r\n            response['reqStatus'] = true;\r\n            response['result'] = result;\r\n        \r\n    }catch(Exception ex){\r\n        failure.insert(\"Exception occured => %s\",ex.toString());\r\n        response['error'] = ex;\r\n    }finally{\r\n         return response;\r\n    }\r\n}\r\n      \r\n      \r\n//ParkingLot Create API\r\n@MicroApi(\r\n          desc = \"ParkingLot Create API Service\",\r\n          params = [\"req_data\"],\r\n          types = [\"string\"], // if declared, make sure it matches the params[]\r\n          required = [],\r\n          roles = [], // domain roles, empty roles for open access\r\n          slug = \"\" // optional short name for REST API access\r\n)\r\ndef create(def args) {\r\n\r\n    def response = [reqStatus:false];\r\n    \r\n    def jsonSlurper = new JsonSlurper();\r\n    \r\n    try{\r\n        def inputObj = jsonSlurper.parseText(args.req_data);\r\n        def Id = util.uuid().toString();\r\n        def result = record.insert(2001, Id, inputObj);\r\n        \r\n        response['result'] = \"ParkingLot created successfully!\";\r\n        response['reqStatus'] = true;\r\n        \r\n    }catch(Exception ex){\r\n        failure.insert(\"Exception occured => %s\",ex.toString());\r\n        response['error'] = ex;\r\n    }finally{\r\n         return response;\r\n    }\r\n}\r\n\r\n      \r\n//ParkingLot Update API\r\n@MicroApi(\r\n          desc = \"ParkingLot Update API Service\",\r\n          params = [\"req_data\",\"id\"],\r\n          types = [\"string\",\"string\"], // if declared, make sure it matches the params[]\r\n          required = [],\r\n          roles = [], // domain roles, empty roles for open access\r\n          slug = \"\" // optional short name for REST API access\r\n)\r\ndef update(def args) {\r\n\r\n    def response = [reqStatus:false];\r\n    \r\n    def jsonSlurper = new JsonSlurper();\r\n    \r\n    try{\r\n        def Id = args.id;\r\n        if(Id != \"\"){\r\n            def updateObj = jsonSlurper.parseText(args.req_data);\r\n            def inputCheck = record.get(2001, Id);\r\n            \r\n            if(inputCheck != null){\r\n                record.insert(2001, Id, updateObj); \r\n                response['result'] = \"ParkingLot updated successfully!\";\r\n                response['reqStatus'] = true;\r\n            }else{\r\n                response['message'] = \"ParkingLot not found!\";\r\n                response['reqStatus'] = false;\r\n            }\r\n        }else{\r\n                response['message'] = \"ParkingLot ID missing\";\r\n                response['reqStatus'] = false;\r\n        }\r\n    }catch(Exception ex){\r\n        failure.insert(\"Exception occured => %s\",ex.toString());\r\n        response['error'] = ex;\r\n    }finally{\r\n         return response;\r\n    }\r\n}\r\n\r\n\r\n      \r\n//ParkingLot Delete API\r\n@MicroApi(\r\n          desc = \"ParkingLot Delete API Service\",\r\n          params = [\"id\"],\r\n          types = [\"string\"], // if declared, make sure it matches the params[]\r\n          required = [],\r\n          roles = [], // domain roles, empty roles for open access\r\n          slug = \"\" // optional short name for REST API access\r\n)\r\ndef delete(def args) {\r\n\r\n    def response = [reqStatus:false];\r\n    \r\n    def jsonSlurper = new JsonSlurper();\r\n    \r\n    try{\r\n        def Id = args.id;\r\n        if(Id != \"\"){\r\n            \r\n           def inputCheck = record.get(2001, Id);\r\n            \r\n            if(inputCheck != null){\r\n                record.delete(2001, Id);\r\n                response['result'] = \"ParkingLot deleted successfully!\";\r\n                response['reqStatus'] = true;\r\n            }else{\r\n                response['message'] = \"ParkingLot not found !\";\r\n                response['reqStatus'] = false;\r\n            }\r\n        }else{\r\n                response['message'] = \"ParkingLot ID missing\";\r\n                response['reqStatus'] = false;\r\n        }\r\n    }catch(Exception ex){\r\n        failure.insert(\"Exception occured => %s\",ex.toString());\r\n        response['error'] = ex;\r\n    }finally{\r\n         return response;\r\n    }\r\n}","authType":"TOKEN","apiKey":null,"props":null,"createdStamp":1670961686434,"updatedStamp":1671082733820,"createdBy":"bob@kstechnologies.com","updatedBy":"bob@kstechnologies.com","allowedMethods":null,"methods":[{"name":"update","desc":"ParkingLot Update API Service","slug":"update","params":[{"name":"req_data","type":"string","required":true},{"name":"id","type":"string","required":true}],"roles":[]},{"name":"list","desc":"ParkingLot List API Service","slug":"list","params":[{"name":"garage_id","type":"string","required":true},{"name":"domain_key","type":"string","required":true}],"roles":[]},{"name":"delete","desc":"ParkingLot Delete API Service","slug":"delete","params":[{"name":"id","type":"string","required":true}],"roles":[]},{"name":"create","desc":"ParkingLot Create API Service","slug":"create","params":[{"name":"req_data","type":"string","required":true}],"roles":[]}]}}